<link rel="stylesheet" type="text/css" href="./styles/index.css" />
<link rel="stylesheet" type="text/css" href="./styles/toggle-style.css" />
  <div id="magicWall" class="magicContainer">

    <div id="themeSwitch">
        <select id="combobox">
        <option value="dark">ThemeDark</option>
        <option value="light">ThemeLight</option>
      </select>
    </div>

    <div id="linkShortner">
      <label for="url" id="labelUrl">Digite a URL para encurtar:</label>
    <input type="text" id="url" placeholder="Cole sua URL aqui">
    <button id="buttonUrl" onclick="enviarUrl()">Encurtar URL</button>
    
    <h4 id="messageUrl">URL Encurtada:</h4>
    <p id="resultado"></p>
    </div>

    

    <!-- Lampada apagada -->
  <div id="lamp-container">

    <!-- Scalable Vector Graphics aka SVG -->
    <svg fill="#000000" height="256px" width="256px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-61.44 -61.44 634.88 634.88" xml:space="preserve" stroke="#000000" stroke-width="0.00512" transform="rotate(0)" class="lampImage">
      <g id="SVGRepo_bgCarrier" stroke-width="0" transform="translate(99.84,99.84), scale(0.61)">
        <rect id="lampFill" x="-61.44" y="-61.44" width="634.88" height="634.88" rx="317.44" fill="transparent" strokewidth="0"/>
      </g>

      <g 
        class="lampImage" 
        id="lampStroke" 
        stroke-linecap="round" 
        stroke-linejoin="round" 
        stroke="transparent" 
        stroke-width="102.4"
      > 
        <g> 
          <g> 
            <path 
              d="M256,0C155.174,0,73.143,82.027,73.143,182.857c0,67.839,38.46,130.937,98.424,162.232l1.817,25.482 c0.357,5.036,4.719,8.911,9.772,8.464c5.036-0.357,8.826-4.732,8.469-9.768l-2.187-30.661c-0.232-3.259-2.192-6.152-5.134-7.571 c-56.42-27.348-92.875-85.518-92.875-148.178c0-90.741,73.826-164.571,164.571-164.571c90.745,0,164.571,73.83,164.571,164.571 c0,66.919-39.969,126.652-101.821,152.196c-3.201,1.322-5.379,4.339-5.629,7.795l-3.978,55.661 c-0.357,5.036,3.433,9.411,8.469,9.768c0.223,0.018,0.442,0.027,0.661,0.027c4.755,0,8.768-3.679,9.112-8.491l3.58-50.116 c65.732-29.527,107.893-94.402,107.893-166.839C438.857,82.027,356.826,0,256,0z"
            /> 
          </g> 
        </g> 
      <g> 
        <g> 
          <path d="M312.915,420.804l-118.857-27.429c-4.906-1.134-9.83,1.937-10.969,6.857c-1.134,4.92,1.933,9.83,6.853,10.964 l118.857,27.429c0.692,0.161,1.384,0.232,2.067,0.232c4.161,0,7.924-2.857,8.902-7.089 C320.902,426.848,317.835,421.937,312.915,420.804z"/>
        </g> 
      </g> 
        <g> 
          <g> 
            <path d="M312.915,457.375l-118.857-27.429c-4.906-1.134-9.83,1.937-10.969,6.857c-1.134,4.92,1.933,9.83,6.853,10.964 l118.857,27.429c0.692,0.161,1.384,0.232,2.067,0.232c4.161,0,7.924-2.857,8.902-7.089 C320.902,463.42,317.835,458.509,312.915,457.375z"/> 
          </g>
        </g>
        <g>
          <g> 
            <path d="M312.915,493.947l-118.857-27.429c-4.906-1.143-9.83,1.928-10.969,6.857c-1.134,4.92,1.933,9.83,6.853,10.964 l118.857,27.429c0.692,0.161,1.384,0.232,2.067,0.232c4.161,0,7.924-2.857,8.902-7.089 C320.902,499.991,317.835,495.08,312.915,493.947z"/>
          </g>
        </g>
      </g>

      <g 
        id="SVGRepo_iconCarrier"
      > 
        <g> 
          <g> 
            <path d="M256,0C155.174,0,73.143,82.027,73.143,182.857c0,67.839,38.46,130.937,98.424,162.232l1.817,25.482 c0.357,5.036,4.719,8.911,9.772,8.464c5.036-0.357,8.826-4.732,8.469-9.768l-2.187-30.661c-0.232-3.259-2.192-6.152-5.134-7.571 c-56.42-27.348-92.875-85.518-92.875-148.178c0-90.741,73.826-164.571,164.571-164.571c90.745,0,164.571,73.83,164.571,164.571 c0,66.919-39.969,126.652-101.821,152.196c-3.201,1.322-5.379,4.339-5.629,7.795l-3.978,55.661 c-0.357,5.036,3.433,9.411,8.469,9.768c0.223,0.018,0.442,0.027,0.661,0.027c4.755,0,8.768-3.679,9.112-8.491l3.58-50.116 c65.732-29.527,107.893-94.402,107.893-166.839C438.857,82.027,356.826,0,256,0z"/>
          </g> 
        </g> 
      <g> 
        <g> 
          <path d="M312.915,420.804l-118.857-27.429c-4.906-1.134-9.83,1.937-10.969,6.857c-1.134,4.92,1.933,9.83,6.853,10.964 l118.857,27.429c0.692,0.161,1.384,0.232,2.067,0.232c4.161,0,7.924-2.857,8.902-7.089 C320.902,426.848,317.835,421.937,312.915,420.804z"/>
        </g>
      </g> 
      <g> 
        <g> 
          <path d="M312.915,457.375l-118.857-27.429c-4.906-1.134-9.83,1.937-10.969,6.857c-1.134,4.92,1.933,9.83,6.853,10.964 l118.857,27.429c0.692,0.161,1.384,0.232,2.067,0.232c4.161,0,7.924-2.857,8.902-7.089 C320.902,463.42,317.835,458.509,312.915,457.375z"/>
        </g>
      </g> 
      <g>
        <g>
          <path d="M312.915,493.947l-118.857-27.429c-4.906-1.143-9.83,1.928-10.969,6.857c-1.134,4.92,1.933,9.83,6.853,10.964 l118.857,27.429c0.692,0.161,1.384,0.232,2.067,0.232c4.161,0,7.924-2.857,8.902-7.089 C320.902,499.991,317.835,495.08,312.915,493.947z"/>
          </g>
        </g>
      </g>
    </svg>
  </div> 

    <!-- Fio fixo e fio animado dentro dele -->
    <div id="wire-conector">
      <div id="wire-energy">
      </div>
    </div>

      <!-- "Botão Mágico" (interruptor) para ligar/desligar -->
    <div class="toggle-wrapper">
      <div class="toggle normal">
        <input id="toggleMagic" type="checkbox">
        <label class="toggle-item" for="toggleMagic"></label>
      </div>
    </div>
  </div>

<script src="./js/lamp-toggler.js"></script>

<script src="./js/wire-animator.js"></script>

<script src="./js/app.js"></script>

<script src="./js/builder.js"></script>

<script>
  async function enviarUrl() {
      const url = document.getElementById("url").value;
      
      if (!url) {
          alert("insira uma URL");
          return;
      }

      try {
          const response = await fetch('http://localhost:3000/encurtar', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({ url: url })
          });
          
          const data = await response.json();

          if (data.success) {
              document.getElementById("resultado").textContent = data.shortenedUrl;
          } else {
              alert("Erro ao encurtar a URL.");
          }
      } catch (error) {
          console.error("Erro:", error);
          alert("Erro ao tentar conectar com a API.");
      }
  }
</script> 

<script defer>
  const themeDark = {
    '--magic-wall-off': 'rgba(0, 0, 0, 0.8)',
    '--magic-wall-on': '#ffffd1',
    '--wire-on': '#4caf50',
    '--wire-off': '#000',
    '--circle-toggle': 'rgba(255, 255, 255, 0.8)',
  }

  const themeLight = {
    '--magic-wall-off': '#ffffff',
    '--magic-wall-on': '#ffffd1',
    '--wire-on': '#4caf50',
    '--wire-off': '#000',
    '--circle-toggle': 'rgba(0, 0, 0, 0.8)',
  }

  const options = {
    displayActive: 'initial',
    displayInactive: 'none',
    on: 'var(--magic-wall-on)',
    off: 'var(--magic-wall-off)',
    altOnImage: 'lampada acesa',
    altOffImage: 'lampada apagada',
    lampColor: '#ffdd00'
  }

  const magicWall = document.getElementById('magicWall')
  const lampContainer = document.getElementById('lamp-container')

  const wireFill = document.getElementById('wire-energy')
  const toggleSwitch = document.getElementById('toggleMagic')

  const app = appBuilder({
    createMagicApp,
    createWireAnimator,
    magicWall, 
    createLampToggler,
    toggleSwitch, 
    wireFill, 
    lampContainer,
    options,
  })

document.addEventListener('DOMContentLoaded', (event) => {
  const combobox = document.getElementById('combobox');
  const buttonUrl = document.getElementById('buttonUrl');
  const inputUrl = document.getElementById('url');


  combobox.addEventListener('change', () => {
      if (combobox.value == "light") {
        app.applyTheme(themeLight);
        combobox.classList.add("light");
        combobox.classList.remove("dark");
        
        inputUrl.classList.add("light");
        inputUrl.classList.remove("dark");
        
        buttonUrl.classList.add("light");
        buttonUrl.classList.remove("dark");
        
        

        
    } else if (combobox.value == "dark") {
        app.applyTheme(themeDark);
        combobox.classList.add("dark");
        combobox.classList.remove("light");

        inputUrl.classList.add("dark");
        inputUrl.classList.remove("light");
        
        buttonUrl.classList.add("dark");
        buttonUrl.classList.remove("light");
        
        
        }
    });
});

  app.start()
</script>
